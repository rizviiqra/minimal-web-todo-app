<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Minimal custom styles if needed, primarily for focus rings or minor adjustments */
        .task-text {
            word-break: break-word;
        }
        .task-item:hover .delete-button {
            opacity: 1;
            transform: translateX(0);
        }
        .delete-button {
            opacity: 0;
            transform: translateX(10px);
            transition: opacity 0.15s ease-in-out, transform 0.15s ease-in-out;
        }
        /* Style for completed tasks. Tailwind's `line-through` and `text-gray-400` are applied dynamically. */
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased">
    <div class="container max-w-md mx-auto mt-10 p-6 bg-white rounded-lg shadow-xl">
        <h1 class="text-4xl font-extrabold text-center mb-8 text-gray-800">My To-Do List</h1>

        <div class="flex mb-6">
            <input
                type="text"
                id="taskInput"
                placeholder="Add a new task..."
                class="flex-grow p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150 ease-in-out text-gray-700"
                aria-label="New task input"
            >
            <button
                id="addTaskBtn"
                class="bg-blue-600 text-white px-5 py-3 rounded-r-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150 ease-in-out font-semibold shadow-md"
                aria-label="Add task"
            >
                Add
            </button>
        </div>

        <ul id="taskList" class="space-y-3">
            <!-- Tasks will be dynamically inserted here -->
        </ul>
    </div>

    <script>
        // Unique ID generator
        function uuidv4() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        // DOM elements
        const taskInput = document.getElementById('taskInput');
        const addTaskBtn = document.getElementById('addTaskBtn');
        const taskList = document.getElementById('taskList');

        // Initialize tasks array from localStorage or as empty
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

        // Function to save tasks to localStorage
        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        // Function to render tasks
        function renderTasks() {
            taskList.innerHTML = ''; // Clear current list

            tasks.forEach(task => {
                const listItem = document.createElement('li');
                listItem.setAttribute('data-id', task.id);
                listItem.className = `task-item flex items-center justify-between bg-gray-50 p-3 pr-2 rounded-lg shadow-sm hover:bg-gray-100 cursor-pointer transition duration-150 ease-in-out border border-gray-200 ${task.completed ? 'line-through text-gray-400' : 'text-gray-800'}`;
                
                const taskTextSpan = document.createElement('span');
                taskTextSpan.className = 'task-text flex-grow mr-4 py-1';
                taskTextSpan.textContent = task.text;

                const deleteButton = document.createElement('button');
                deleteButton.className = 'delete-button ml-auto p-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition duration-150 ease-in-out flex-shrink-0';
                deleteButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                `;
                deleteButton.setAttribute('aria-label', `Delete task: ${task.text}`);

                listItem.appendChild(taskTextSpan);
                listItem.appendChild(deleteButton);
                taskList.appendChild(listItem);
            });
        }

        // Function to add a new task
        function addTask() {
            const taskText = taskInput.value.trim();
            if (taskText !== '') {
                const newTask = {
                    id: uuidv4(),
                    text: taskText,
                    completed: false
                };
                tasks.push(newTask);
                saveTasks();
                renderTasks();
                taskInput.value = ''; // Clear input field
                taskInput.focus(); // Keep focus on input
            }
        }

        // Function to toggle task completion status
        function toggleComplete(id) {
            tasks = tasks.map(task => 
                task.id === id ? { ...task, completed: !task.completed } : task
            );
            saveTasks();
            renderTasks();
        }

        // Function to delete a task
        function deleteTask(id) {
            tasks = tasks.filter(task => task.id !== id);
            saveTasks();
            renderTasks();
        }

        // Event listeners
        addTaskBtn.addEventListener('click', addTask);

        taskInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                addTask();
            }
        });

        taskList.addEventListener('click', (event) => {
            const clickedElement = event.target;
            const listItem = clickedElement.closest('.task-item'); // Find the closest li parent

            if (!listItem) return; // Not a task item or child of one

            const taskId = listItem.dataset.id;

            if (clickedElement.closest('.delete-button')) {
                // Clicked on the delete button or its SVG icon
                deleteTask(taskId);
            } else if (listItem) {
                // Clicked on the task item itself (text or other part)
                toggleComplete(taskId);
            }
        });

        // Initial render on page load
        document.addEventListener('DOMContentLoaded', renderTasks);
    </script>
</body>
</html>